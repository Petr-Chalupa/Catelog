name: Scheduled API Tasks
on:
    schedule:
        - cron: "0 0 * * 0" # Weekly Enrichment (Sunday 00:00)
        - cron: "0 0 1 * *" # Monthly Maintenance (1st of month 00:00)

jobs:
    trigger-tasks:
        runs-on: ubuntu-latest
        steps:
            - name: Weekly Enrichment
              if: github.event.schedule == '0 0 * * 0'
              run: |
                  curl -X POST "${{ secrets.API_BASE_URL }}/api/system/tasks/enrich" \
                  -H "X-System-Key: ${{ secrets.SYSTEM_MAINTENANCE_KEY }}"

            - name: Monthly Maintenance
              if: github.event.schedule == '0 0 1 * *'
              run: |
                  curl -X POST "${{ secrets.API_BASE_URL }}/api/system/tasks/maintenance" \
                  -H "X-System-Key: ${{ secrets.SYSTEM_MAINTENANCE_KEY }}"
